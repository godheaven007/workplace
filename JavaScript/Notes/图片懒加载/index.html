<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>图片懒加载</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        ul {
            list-style-type: none;
        }

        .list {
            width: 330px;
            height: 600px;
            padding: 10px;
            margin: 20px auto;
            border: 5px solid #ccc;
            overflow-y: scroll;
        }

        .item {
            width: 300px;
            height: 240px;
            margin-bottom: 10px;
        }

        .item>img {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <ul class="list">
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片1" data-img="http://cdn.jirengu.com/book.jirengu.com/img/1.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片2" data-img="http://cdn.jirengu.com/book.jirengu.com/img/2.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片3" data-img="http://cdn.jirengu.com/book.jirengu.com/img/3.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片4" data-img="http://cdn.jirengu.com/book.jirengu.com/img/4.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片5" data-img="http://cdn.jirengu.com/book.jirengu.com/img/5.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片6" data-img="http://cdn.jirengu.com/book.jirengu.com/img/6.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片7" data-img="http://cdn.jirengu.com/book.jirengu.com/img/7.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片8" data-img="http://cdn.jirengu.com/book.jirengu.com/img/8.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片9" data-img="http://cdn.jirengu.com/book.jirengu.com/img/9.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片10" data-img="http://cdn.jirengu.com/book.jirengu.com/img/10.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片11" data-img="http://cdn.jirengu.com/book.jirengu.com/img/11.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片12" data-img="http://cdn.jirengu.com/book.jirengu.com/img/12.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片13" data-img="http://cdn.jirengu.com/book.jirengu.com/img/13.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片14" data-img="http://cdn.jirengu.com/book.jirengu.com/img/14.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片15" data-img="http://cdn.jirengu.com/book.jirengu.com/img/15.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片16" data-img="http://cdn.jirengu.com/book.jirengu.com/img/16.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片17" data-img="http://cdn.jirengu.com/book.jirengu.com/img/17.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片18" data-img="http://cdn.jirengu.com/book.jirengu.com/img/18.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片19" data-img="http://cdn.jirengu.com/book.jirengu.com/img/19.jpg">
        </li>
        <li class="item">
            <img src="http://smashinghub.com/wp-content/uploads/2014/08/cool-loading-animated-gif-3.gif" alt="图片20" data-img="http://cdn.jirengu.com/book.jirengu.com/img/20.jpg">
        </li>
    </ul>

    <script>
        function $(selector) {
            return document.querySelector(selector);
        }
        // 图片是否刚出现在视口中（视口高度 + 向上滚动距离 >= 元素距离容器顶部的距离）
        function isAppear(container, ele) {
            return container.clientHeight + container.scrollTop >= ele.offsetTop;
        }
        // 加载图片
        function loadImg(container, imgNodes) {
            
            imgNodes.forEach(function (node, index) {
                if (!node.dataset.loaded) {
                    // 图片是否加载过，未加载则加载
                    if (isAppear(container, node)) {
                        var imgSrc = node.dataset.img;
                        node.src = imgSrc;
                        node.dataset.loaded = 1;
                    }
                } else {
                    // 已加载，则无需加载
                }
            });
        }



        document.addEventListener('DOMContentLoaded', function () {
            var container = $('.list'),
                imgNodes = document.querySelectorAll('img');
            // 页面初次加载
            loadImg(container, imgNodes);
            container.addEventListener('scroll', function (e) {
                // TODO...函数防抖处理，否则频繁触发滚动事件
                loadImg(container, imgNodes);
            });
        });
    </script>
</body>

</html>